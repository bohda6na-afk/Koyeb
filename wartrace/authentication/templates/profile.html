<!DOCTYPE html>
<html>
<head>
    <title>Personal Page</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/personal_page.css' %}">
</head>
<body>
    <header>
        <h1>{{ user.first_name }} {{ user.last_name }}</h1>
        <p>{{ user.profile.get_category_display }}</p>
        <p>{{ user.email }}</p>
    </header>

    <aside>
        <div class="contact-info">
            <h2>Contact info</h2>
            <p>Email: {{ user.email }}</p>
            <p>Tel: {{ contacts.phone|default:"Not provided" }}</p>
            <p>Social: {% if contacts.socials.title and contacts.socials.link %}<a href="{{ contacts.socials.link }}">{{ contacts.socials.title }}</a>{% else %}Not provided{% endif %}</p>
        </div>

    </aside>

    <main>
        <div class="archive-section">
            <h2>Archive</h2>
            {% if both_request_data %}
            {% for name, req_data in both_request_data %}
            <h3>{{name}}</h3>
            {% if req_data %}
            <table>
                <thead>
                    <tr>
                        <th>–ó–∞–≥–æ–ª–æ–≤–æ–∫</th>
                        <th>–û–ø–∏—Å</th>
                        <th>–¶—ñ–Ω–∞ (–≥—Ä–Ω)</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                    </tr>
                </thead>
                {% for req in req_data %}
                <tbody>
                    <td>{{ req.name }}</td>
                    <td>{{ req.description }}</td>
                    <td>{{ req.aproximate_price }}</td>
                    <td>{{ req.get_status_display }}<br>{% if visitor.pk == req.volunteer.pk or visitor.pk == req.author.pk %}<a href="{% url 'chat:start_chat' req.id %}">–ù–∞–ø–∏—Å–∞—Ç–∏</a>{% endif %}</td>
                </tbody>
                {% endfor %}
            </table>
            {% else %}
            <p>–©–µ –Ω–µ–º–∞ –∑–∞–ø–∏—Ç—ñ–≤.</p>
            {% endif %}
            {% endfor %}
        {% endif %}
        {% if request_data %}
        <table>
            <thead>
                <tr>
                    <th>–ó–∞–≥–æ–ª–æ–≤–æ–∫</th>
                    <th>–û–ø–∏—Å</th>
                    <th>–¶—ñ–Ω–∞ (–≥—Ä–Ω)</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                </tr>
            </thead>
            {% for req in request_data %}
            <tbody>
                <td>{{ req.name }}</td>
                <td>{{ req.description }}</td>
                <td>{{ req.aproximate_price }}</td>
                <td>{{ req.get_status_display }}<br>{% if visitor.pk == req.volunteer.pk or visitor.pk == req.author.pk %}<a href="{% url 'chat:start_chat' req.id %}">–ù–∞–ø–∏—Å–∞—Ç–∏</a>{% endif %}</td>
            </tbody>
            {% endfor %}
        </table>
        {% elif not both_request_data %}
        <p>–©–µ –Ω–µ–º–∞ –∑–∞–ø–∏—Ç—ñ–≤.</p>
        {% endif %}
        </div>
    </main>

    <div class="bottom-menu">
        <a href="{% url 'map' %}">–ö–∞—Ä—Ç–∞ üî•</a>
        <a href="{% url 'volunteer_app:chat_history' %}">üïì –Ü—Å—Ç–æ—Ä—ñ—è —á–∞—Ç—ñ–≤</a>
        {% if not request_form %}
        <a href="{% url 'personal_page' %}">–û—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç üë§</a>
        {% endif %}
    </div>
</body>
</html>